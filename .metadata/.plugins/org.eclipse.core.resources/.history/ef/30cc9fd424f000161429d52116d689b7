<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Team Entry Form</title>
<link rel="stylesheet" type="text/css" href="<%=request.getContextPath()%>/css/style.css"/>

<script type="text/javascript" src="js/jquery.1.7.2.min.js"></script>
<script type="text/javascript" src="js/jquery-ui.js"></script> 
<script type="text/javascript" src="js/jquery.currency.js"></script> 

</head>
<body>


<script  type="text/javascript">
$(document).ready(function(){
	
	
	$.ajax({
		type:"post",
		url:"/SportManagmentSystem/TeamEntryServlet",
		data:{dataSend:"category"},  
		datatype:"json",
		 success:function(data, textStatus, jqXHR)
         {
	    	var e=jQuery.parseJSON(data);	          
	    	console.log("category"+e);    
	        var options = '';
	        options += '<option value="NotSelected">Select the Game Category</option>';
			 if(e!=undefined && e!=null && e!="" ){ 
				$.each(e, function(key, value){
					options += '<option value="' + key + '">' + value + '</option>';
				});
			}
	        $("#category").html(options);	        
	        
				     
         },
         error:function(xhr,status){
             console.log(status);
      }
	});
	
	
	$("#category").change(function(){
		 if($(this).val()!="NotSelected"){
			$.ajax({
			       type: "post",
			       url:"/SportManagmentSystem/TeamEntryServlet",
			       data:"dataSend=age&&category="+$(this).val(),   
			       
			       success:function(data, textStatus, jqXHR)
		      {
			   	var e=jQuery.parseJSON(data);
			    var options = '';
		     	options += '<option value="NotSelected">Select Age</option>';
				if(e!=undefined && e!=null && e!="" ){
					$.each(e, function(key, value){
						options += '<option value="' + key + '">' + value + '</option>';
					});		     	
				}
		     $("#age").html(options);
		 },
		 error:function(xhr,status){
		        console.log(status);
		 }
		 });
		}	
	 });
	
	
	$("#searchBtn").click(function(){
		$.ajax({
		       type: "post",
		       url:"/SportManagmentSystem/TeamEntryServlet",
		       data:"dataSend=searchBtn&&category="+$("#category").val()+"&&age="+$("#age").val()+"&&gender="+$("#gender").val(),      
		       success:function(data, textStatus, jqXHR)
			      {
		    		var e=jQuery.parseJSON(data);
				    var options = '';
			     	options += '<option value="NotSelected">Select Captain</option>';
					if(e!=undefined && e!=null && e!="" ){
						$.each(e, function(key, value){
							options += '<option value="' + key + '">' + value + '</option>';
						});		     	
					}
			     $("#captainlist").html(options);
			      },		      
			      error:function(xhr,status){
				        console.log(status);
				 }
		});
	});
	
	$("#captainlist").change(function(){
		 if($(this).val()!="NotSelected"){
			 
			 //alert($('#captainlist').text());
	    	    alert($('#captainlist').val());
	    	    
			$.ajax({
			       type: "post",
			       url:"/SportManagmentSystem/TeamEntryServlet",
			       data:"dataSend=age&&category="+$(this).val(),   
			       
			       success:function(data, textStatus, jqXHR)
		      {
			    	  
		 },
		 error:function(xhr,status){
		        console.log(status);
		 }
		 });
		}	
	 });
	
	
	$("#addBtn").click(function(){
		var jsonData={
				"FIRST_NAME":$('#fistnameText').val(),
				"LAST_NAME":$('#lastnameText').val(),
				"MIDDLE_NAME":$('#middlenameText').val(),
				"DOB":$('#dobText').val(),
				"AGE":$('#ageText').val(),
				"GENDER":$('#genderText').val(),
				"ADDRESS_LINE":$('#addressText').val(),
				"STATE":$('#stateText').val(),
				"CITY":$('#cityText').val(),
				"PINCODE":$('#pincodeText').val(),
				"PHONE":$('#phoneText').val(),
				"EMERGENCY_PHONE":$('#emergencyPhoneText').val(),
				"EMAIL":$('#emailText').val()
		};
		$.ajax({	
		       type: "post",
		       url:"/SportManagmentSystem/TeamEntryServlet",
		       data:{dataSubmit:JSON.stringify(jsonData)},   
		       datatype:"json",
		       success:function(data, textStatus, jqXHR)
	            {		    	   
		    	   var optionCat ='';
		    	   $("#partitable").find("tr:gt(0)").remove();
		    	   var trHTML = '';	
		    	   $('#tablediv').show();
		    	   console.log("submit:"+data);
		    	   console.log("length :"+data.length);

		            $.each(data, function(index, slab) {  
		            	trHTML += '<tr><td class=\"td\">'
				        +"<img src='css/images/edit.png' class='btnEdit'/></td>"
		            	+'<td class=\"td\"id=\"fistnameText\" >' + slab.FIRST_NAME + 
		            	'</td><td class=\"td\" id=\"lastnameText\">' + slab.LAST_NAME +
		            	'</td><td class=\"td\" id=\"middlenameText\" >' + slab.MIDDLE_NAME + 
		            	'</td><td class=\"td\" id=\"dobText\">'+ slab.DOB + 
		            	'</td><td class=\"td\" id=\"ageText\">' + slab.AGE + 
		            	'</td><td class=\"td\" id=\"genderText\" >' + slab.GENDER + 
		            	'</td><td class=\"td\" id=\"addressText\" >' + slab.ADDRESS_LINE + 
		            	'</td><td class=\"td\" id=\"stateText\">' + slab.STATE + 
		            	'</td><td class=\"td\" id=\"cityText\">' + slab.CITY + 
		            	'</td><td class=\"td\" id=\"pincodeText\">' + slab.PINCODE + 
		            	'</td><td class=\"td\" id=\"phoneText\">' + slab.PHONE + 
		            	'</td><td class=\"td\"  id=\"emergencyPhoneText\">' + slab.EMERGENCY_PHONE + 
		            	'</td><td class=\"td\" id=\"emailText\">' + slab.EMAIL + 
		            	'</td></tr>';
		            	console.log(slab);
		            	console.log("index "+index);
		            	$(".btnEdit").live("click",Edit); 
		        
		            		function Save(){ 
		            			var dataToSend =[];
		            			var par = $(this).parent().parent(); //tr 
		            			var tdButtons = par.children("td:nth-child(1)"); 
			            		var tdfistnameText= par.children("td:nth-child(2)"); 
			            		var tdmiddlenameText = par.children("td:nth-child(3)"); 
			            		var tdlastnameText = par.children("td:nth-child(4)"); 
			            		var tddobText = par.children("td:nth-child(5)");
			            		var tdageText = par.children("td:nth-child(6)");
			            		var tdgenderText = par.children("td:nth-child(7)");
			            		var tdaddressText = par.children("td:nth-child(8)");
			            		var tdstateText = par.children("td:nth-child(9)");
			            		var tdcityText = par.children("td:nth-child(10)");
			            		var tdphoneText = par.children("td:nth-child(11)");
			            		var pincodeText = par.children("td:nth-child(11)");
			            		var tdemergencyPhoneText = par.children("td:nth-child(12)");
			            		var tdemailText = par.children("td:nth-child(13)");
			            		var data = {};
			            					            					            		
			            		data["FIRST_NAME"] = tdfistnameText.html();
			            		dataToSend.push(data);
			            		
			            		data["LAST_NAME"] = tdlastnameText.html();
			            		dataToSend.push(data);
			            		
			            		data["MIDDLE_NAME"] = tdmiddlenameText.html();
			            		dataToSend.push(data);
			            		
			            		data["DOB"] = tddobText.html();
			            		dataToSend.push(data);
			            		
			            		data["AGE"] = tdageText.html();
			            		dataToSend.push(data);
			            		
			            		data["GENDER"] =tdgenderText.html();
			            		dataToSend.push(data);
			            		
			            		data["ADDRESS_LINE"] = tdaddressText.html();
			            		dataToSend.push(data);
			            						            	
			            		$('input:text').each(function(index){			            					
			            	        data[$(this).attr('id')] =$(this).val();
			            	        dataToSend.push(data);
	            				});
	            							            		
			            		//tdSlabCategory.html(tdSlabCategory.children($('optionCat')).val());
			            		//tdSlabType.html(tdSlabType.children($('optionType')).val());
			            		//tdMinSlab.html(tdMinSlab.children("input[type=text]").val());
			            		//tdMaxSlab.html(tdMaxSlab.children("input[type=text]").val());
			            		//tdCharges.html(tdCharges.children("input[type=text]").val());
			            		//tdSlabEndDate.html(tdSlabEndDate.children("input[type=text]").val());
		            			
			            		tdButtons.html("<img src='css/images/edit.png' class='btnEdit'/>"); 
		            			$(".btnEdit").live("click", Edit); 
		            			
		            			
		            			data["STATE"] = tdstateText.html();
			            		dataToSend.push(data);
			            	
			            		data["CITY"] = tdcityText.html();
			            		dataToSend.push(data);
			            		
			            		data["PINCODE"] = tdphoneText.html();
			            		dataToSend.push(data);
			            		
			            		
		            			console.log("dataToSend length: "+dataToSend.length);
		            			
		            			$.ajax({
		            			       type: "post",s
		            			       url:"getSlabDataServlet",
		            			       data:{dataEdit:JSON.stringify(dataToSend)}, 
		            			     		            			       
		            			       datatype:"json",
		            			       success:function(data, textStatus, jqXHR)
		            		            {
		            			    	   var e=jQuery.parseJSON(data);
		            			              if(e.status==="success"){
		            				    		   alert("Update Done");
		            				    	   }
		            				    	   else if(e.status==="error"){
		            				    		   alert("ERROR");   
		            				    	   }
		            		            }
		            			});
		            			
		            		}; 
						
		            	
		            });
		    	   
		            $('#slabtable').append(trHTML);

		    	   
	            }
			
		});
		
	});
});
</script>
<form>
<div class=container></div>

<div ></div>
	<div class="labels_category"><span>Please select category:</span></div><select id="category"></select>
	<div class="labels_age"><span>Please select age:</span></div><select id="age"></select>
	<div class="labels_gender"><span>Please select gender:</span></div><select id="gender">
	<option value="select">Select a gender</option> 
	<option  value="B">B</option> 
	<option value="G">G</option> 
	</select>
	
<div class="buttondiv">
		<input type="button" name="searchBtn" id="searchBtn" value="Search Captain">
</div>
	
<select id="captainlist">	

<div id="tablediv">
<table cellspacing="1px" id="partitable" class="table"> 
    <tr class="tr"> 
    	<th class="th" scope="col">First Name</th>
        <th class="th" scope="col">Middle Name</th> 
        <th class="th" scope="col">Last Name</th> 
        <th class="th" scope="col">Date Of Birth</th> 
        <th class="th" scope="col">Age</th> 
        <th class="th" scope="col">Gender</th> 
        <th class="th" scope="col">Address</th>  
        <th class="th" scope="col">State</th>  
        <th class="th" scope="col">City</th>  
        <th class="th" scope="col">Pincode</th>  
        <th class="th" scope="col">Phone</th>
        <th class="th" scope="col">Emergency Phone</th>
        <th class="th" scope="col">Email</th>          
    </tr> 
</table>
</div>
	
<div class="buttondiv">
		<input type="button" name="addBtn" id="addBtn" value="Add Record">
</div>

<input type="text" class="firstname"  id="fistnameText" value="sampada">
<input type="text" class="lastname"  id="lastnameText" value="sampada">
<input type="text" class="middlename"  id="middlenameText" value="sampada">
<input type="text" class="dob"  id="dobText" value="sampada">
<input type="text" class="age"  id="ageText" value="sampada">
<input type="text" class="gender"  id="genderText" value="sampada">
<input type="text" class="addressline"  id="addressText" value="sampada">
<input type="text" class="state"  id="stateText" value="sampada">
<input type="text" class="city"  id="cityText" value="sampada">
<input type="text" class="pincode"  id="pincodeText" value="sampada">
<input type="text" class="phone"  id="phoneText" value="sampada">
<input type="text" class="emergencyphone"  id="emergencyPhoneText" value="sampada">
<input type="text" class="email"  id="emailText" value="sampada">



</form>


</body>
</html>  