package com.sports.event.generics;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.sports.dbconnections.DataBaseConnection;

public class DataBaseCalls {
	
	public DataBaseCalls() throws ClassNotFoundException, SQLException{
		DataBaseConnection dbcon = new DataBaseConnection();
	}
	
	
	public ArrayList<Integer>  getCount(String TableName , int gameId){	
		String query = "SELECT PART_ID FROM Sport_Database.PARTI_GAME WHERE GAME_ID = " + gameId;
		Statement stmt;
		ResultSet rs = null;
		
		try {
			stmt = DataBaseConnection.getCon().createStatement();
			rs = stmt.executeQuery(query);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		ArrayList<Integer> participantList = new ArrayList<Integer>();
		try {
			while(rs.next()){
				participantList.add(rs.getInt("PART_ID"));
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

		return participantList;
	}
	
public String getGameDetail(int gameId) throws ClassNotFoundException, SQLException{
		
		String query = "SELECT TYPE FROM Sport_Database.GAME WHERE GAME_ID = " + gameId;
		Statement stmt = DataBaseConnection.getCon().createStatement();
		ResultSet rs = stmt.executeQuery(query);
		
		String gameType = "";
		while(rs.next()){
			gameType = rs.getString("TYPE");
		}
		return gameType;
	}

public String getGameID(String gameName,String age,String gender) throws ClassNotFoundException, SQLException{
	
	String query = "SELECT GAME_ID FROM Sport_Database.GAME WHERE DISCIPLINE = '"+gameName+"'"+ 
			" and AGE_GRP = '"+age+"' and CATEGORY = '"+gender+"'"   ;
	
	System.out.println("Query " + query);
	Statement stmt = DataBaseConnection.getCon().createStatement();
	ResultSet rs = stmt.executeQuery(query);
	
	String gameId = "";
	while(rs.next()){
		gameId = rs.getString("GAME_ID");
	}
	return gameId;
}



public Map<Integer,List<String>> getInitialRoundDetail() throws ClassNotFoundException, SQLException{
	
	String query = "SELECT DISCIPLINE,AGE_GRP,CATEGORY FROM Sport_Database.GAME";
	Statement stmt = DataBaseConnection.getCon().createStatement();
	ResultSet rs = stmt.executeQuery(query);
	
	List<String> arr_Discipline = new ArrayList<String>();
	List<String> arr_Age = new ArrayList<String>();
	List<String> arr_Category = new ArrayList<String>();
	Map<Integer,List<String>> map_GameDtl = new HashMap<Integer,List<String>>();
	
	while(rs.next()){
		arr_Discipline.add(rs.getString("DISCIPLINE").trim());
		arr_Age.add(rs.getString("AGE_GRP").trim());
		arr_Category.add(rs.getString("CATEGORY").trim());
	}
	
	map_GameDtl.put(1, arr_Discipline);
	map_GameDtl.put(2, arr_Age);
	map_GameDtl.put(3, arr_Category);
	
	return map_GameDtl;
}


}
